{"version":3,"sources":["../../src/drag-events/target.js"],"names":[],"mappings":"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","file":"target.js","sourcesContent":["/**\n * Module dependencies\n */\n\nimport hg from 'mercury';\n\nimport { TARGET_EVENTS } from './setup';\n\n/**\n *\n */\n\nexport default hg.BaseEvent(handleDrag);\n\n// TODO: Allow to be able to specify the events that we want\n// to listent to, via `this.data`.\n// If not specified listen to all `TARGET_EVENTS`\nfunction handleDrag(ev, broadcast) {\n  // Ignore other events\n  if (!isDragEvent(ev)) return;\n\n  const data = this.data;\n  const delegator = hg.Delegator();\n  const _target = ev.currentTarget/* || ev.target*/;\n  let listenersAdded = false; // TODO: Check if can remove this\n\n  if (ev.type === 'dragenter') {\n    const triggerDragenter = !listenersAdded;\n    addListeners();\n    if (triggerDragenter) dragenter(ev);\n  }\n\n  function dragenter(e) {\n    if (!isRootElementOfEvent(e)) return;\n\n    broadcast(addData({\n      type: 'dragenter',\n      target: e.target,\n    }));\n  }\n\n  function dragover(e) {\n    if (!isRootElementOfEvent(e)) return;\n\n    const raw = e._rawEvent;\n\n    // Allows us to drop\n    if (e.preventDefault) e.preventDefault();\n    else if (raw.preventDefault) raw.preventDefault();\n\n    raw.dataTransfer.dropEffect = 'move';\n\n    // broadcast(addData({\n    //   type: 'dragover',\n    //   target: e.target,\n    //   dataTransfer: raw.dataTransfer,\n    // }));\n    // //REF//\n\n    return false;\n  }\n\n  function dragleave(e) {\n    if (!isRootElementOfEvent(e)) return;\n\n    removeListeners();\n\n    broadcast(addData({\n      type: 'dragleave',\n      target: e.target,\n    }));\n  }\n\n  function drop(e) {\n    if (!isRootElementOfEvent(e)) return;\n\n    const raw = e._rawEvent;\n\n    // Stops the browser from redirecting\n    if (e.stopPropagation) e.stopPropagation();\n    else if (raw.stopPropagation) raw.stopPropagation();\n\n    removeListeners();\n\n    broadcast(addData({\n      type: 'drop',\n      target: e.target,\n      dataTransfer: raw.dataTransfer,\n    }));\n  }\n\n  function addData(additional) {\n    return Object.assign({}, data, additional);\n  }\n\n  function isRootElementOfEvent(e) {\n    return e.target === _target;\n  }\n\n  function addListeners() {\n    if (listenersAdded) return;\n\n    delegator.addGlobalEventListener('dragenter', dragenter);\n    delegator.addGlobalEventListener('dragover', dragover);\n    delegator.addGlobalEventListener('dragleave', dragleave);\n    delegator.addGlobalEventListener('drop', drop);\n    listenersAdded = true;\n  }\n\n  function removeListeners() {\n    if (!listenersAdded) return;\n\n    delegator.removeGlobalEventListener('dragenter', dragenter);\n    delegator.removeGlobalEventListener('dragover', dragover);\n    delegator.removeGlobalEventListener('dragleave', dragleave);\n    delegator.removeGlobalEventListener('drop', drop);\n    listenersAdded = false;\n  }\n}\n\n/**\n *\n */\n\nfunction isDragEvent(ev) {\n  return ~TARGET_EVENTS.indexOf(ev.type);\n}\n"]}